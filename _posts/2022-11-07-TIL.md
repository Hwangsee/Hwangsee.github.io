---
title: 221107 TIL | íŠ¸ìœ„í„° í´ë¡ ì½”ë”©_(2)
tags: [React, firebase, TIL]
---

### ì˜¤ëŠ˜ í•œ ì¼

- ë…¸ë§ˆë“œì½”ë” íŠ¸ìœ„í„° í´ë¡ ì½”ë”© ì‹¤ìŠµ
    - Firestore Database ìƒì„±
    - íŠ¸ìœ— ìƒì„±, ìˆ˜ì •, ì‚­ì œ ê¸°ëŠ¥ êµ¬í˜„
    - RealTime ì—°ë™ì„ ìœ„í•´ íŠ¸ìœ—ì„ onSnapshot()ìœ¼ë¡œ ê°€ì ¸ì˜¤ë„ë¡ ë³€ê²½

## FireStore ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±í•˜ê¸°

![Untitled](https://user-images.githubusercontent.com/76581207/200305712-19c7a347-b3e9-4e96-b11f-f0e17d2f741f.png)

![Untitled2](https://user-images.githubusercontent.com/76581207/200305930-44764e8a-744a-409e-a0c7-b6f5271340bc.png)

![Untitled3](https://user-images.githubusercontent.com/76581207/200306016-2efbf584-d6e3-407a-b502-98a9ef3c268c.png)

/fbase.js

- ì‚¬ìš©í•˜ê³ ìž í•˜ëŠ” ê¸°ëŠ¥ì€ import í•´ì•¼ ì“¸ ìˆ˜ ìžˆë‹¤.

```jsx
import "firebase/database";
```

Cloud Firestoreì˜ databaseëŠ” NoSQL ë°ì´í„°ë² ì´ìŠ¤ì´ë‹¤.

#### NoSQLì˜ íŠ¹ì§•

- Collection
- Document

Collectionì€ Documentì˜ ê·¸ë£¹ì´ë‹¤.

ìœ íŠœë¸Œë¼ëŠ” ê¸°ëŠ¥ì„ ë§Œë“ ë‹¤ë©´ ë¹„ë””ì˜¤ ì½œë ‰ì…˜, ëŒ“ê¸€ ì½œë ‰ì…˜ ë“±ì„ ê°€ì§ˆ ìˆ˜ ìžˆì„ ê²ƒì´ë‹¤.

ì½œë ‰ì…˜ì— ì›í•˜ëŠ”ë§Œí¼ í•„ë“œë¥¼ ë§Œë“¤ê³  íƒ€ìž…ì„ ì§€ì •í•  ìˆ˜ ìžˆë‹¤.

ì›¹ì‚¬ì´íŠ¸ì—ì„œë„ ì½œë ‰ì…˜ì„ ë§Œë“¤ ìˆ˜ ìžˆì§€ë§Œ ì½”ë“œ ìƒì—ì„œë„ ë§Œë“¤ ìˆ˜ ìžˆìœ¼ë‹ˆ, ë§Œë“¤ì–´ë³´ìž.

> â—Â firebaseì—ì„œ ì‚¬ìš©í•˜ê³ ìž í•˜ëŠ” ê¸°ëŠ¥ì€ importë¥¼ í•´ì•¼ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.
> 
> 
> `import "firebase/firestore";`
> 

#### CollectionReference ë¬¸ì„œ

- [https://firebase.google.com/docs/reference/js/v8/firebase.firestore.CollectionReference](https://firebase.google.com/docs/reference/js/v8/firebase.firestore.CollectionReference)

```jsx
const onSubmit = (event) => {
    event.preventDefault();
    dbService.collection("hweets").add({
      // ì–´ë–¤ ë°ì´í„°ë“  ìž…ë ¥ ê°€ëŠ¥í•˜ë‹¤.
      hweet,
      createAt: Date.now(),
    });
    setHweet("");
  };
```

ì—¬ê¸°ê¹Œì§€ í–ˆëŠ”ë°, onSubmití•´ë„ íŠ¸ìœ— ìƒì„±ì´ ì•ˆ ë¨.

> 1ï¸âƒ£   Database locationì„ asia-northeast3ë¡œ ìƒì„±í•˜ì§€ ì•Šìœ¼ë©´ await ì‹¤í–‰ì´ ë˜ì§€ ì•ŠëŠ” ì´ìŠˆê°€ ìžˆë‹¤.
****í´ë¼ìš°ë“œ ìœ„ì¹˜ ì°¸ê³  : [https://firebase.google.com/docs/firestore/locations?hl=ko#location-r](https://firebase.google.com/docs/firestore/locations?hl=ko#location-r)
> 

â†’ ê°™ì€ ì•„ì‹œì•„ì¸ë° ì‹¤í–‰ì´ ì•ˆ ë  ìˆ˜ê°€ ìžˆë‚˜â€¦? ì‹¶ì—ˆëŠ”ë° í”„ë¡œì íŠ¸ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ë³´ë‹ˆ ì•ˆ ëœë‹¤..

> 2ï¸âƒ£Â   form íƒœê·¸ì— onSubmit ì´ë²¤íŠ¸ë¥¼ ë‹¬ì•˜ì–´ì•¼ í–ˆëŠ”ë° input íƒœê·¸ì— ì´ë²¤íŠ¸ë¥¼ ë‹¬ì•„ì„œ ì‹¤í–‰ì´ ì•ˆ ëì—ˆë‹¤.. ðŸ¥²
> 

### CollectionReference.onsnapshot

- [https://firebase.google.com/docs/reference/js/v8/firebase.firestore.CollectionReference#onsnapshot](https://firebase.google.com/docs/reference/js/v8/firebase.firestore.CollectionReference#onsnapshot)
- onsnapshotì€ DBì˜ ìƒíƒœë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì•Œë ¤ì¤€ë‹¤. (read, delete, update ë“±â€¦)

```jsx
useEffect(() => {
    getHweets();
    dbService.collection("hweets").onSnapshot((snapshot) => {
      console.log("ë­”ê°€ ì¼ì–´ë‚˜ëŠ” ì¤‘..");
    });
  }, []);
```

- ë¦¬ì–¼íƒ€ìž„ ì—°ë™ì„ ìœ„í•´ `collection("hweets").get();` ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ì†ŒìŠ¤ ì½”ë“œë¥¼ ì§€ìš°ê³  `collection("hweets").onSnapshot` ìœ¼ë¡œ ê°€ì ¸ì˜¤ë„ë¡ ìˆ˜ì •í•œë‹¤.

```jsx
useEffect(() => {
    dbService.collection("hweets").onSnapshot((snapshot) => {
      const nweetArray = snapshot.docs.map((doc) => ({
        id: doc.id,
        ...doc.data(),
      }));
      setHweets(nweetArray);
    });
  }, []);
```

